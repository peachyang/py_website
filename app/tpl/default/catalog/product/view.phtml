<?php
$collection = $this->getVariable('collection');
$product = $this->getProduct();
$images = $product->offsetGet('images');
$warehouse = new Seahinet\Catalog\Model\Warehouse;
$warehouse->load(1);
$inventory = $warehouse->getInventory($product->getId(), $product['sku']);
?>
<div class="container">
    <form action="<?php echo $this->getBaseUrl('checkout/cart/add/') ?>" method="post" enctype="multipart/form-data">
        <input type="hidden" name="csrf" value="<?php echo $this->getCsrfKey() ?>" />
        <input type="hidden" name="product_id" value="<?php echo $product->getId() ?>" />
        <input type="hidden" name="warehouse_id" value="<?php echo 1 ?>" />
        <div class="product-detail clearfix">
            <div class="col-lg-4">
                <?php echo $this->getChild('media')->setVariable('product', $product) ?>
                <ul class="links list-inline">
                    <li>
                        <a href="<?php echo $this->getBaseUrl('customer/wishlist/') ?>">
                            <span class="fa fa-star" aria-hidden="true"></span>
                            <span><?php echo $this->translate('Add to Wishlist'); ?></span>
                        </a>
                    </li>
                    <li class="dropdown">
                        <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown">
                            <span class="fa fa-share-alt" aria-hidden="true"></span>
                            <span><?php echo $this->translate('Share'); ?></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="col-lg-6 product-info">
                <h2 class="product-name"><?php echo $product['name'] ?></h2>
                <div class="clearfix price-box">
                    <div class="col-xs-12 col-sm-8">
                        <?php echo $this->getPriceBox() ?>
                    </div>
                    <div class="hidden-xs col-sm-2 review">
                        <span class="count">0</span>
                        <span><?php echo $this->translate('Review(s)', [], 'catalog'); ?></span>
                    </div>
                    <div class="hidden-xs col-sm-2 order">
                        <span class="count">0</span>
                        <span><?php echo $this->translate('Order(s)', [], 'catalog'); ?></span>
                    </div>
                </div>
                <div class="options">
                    <?php echo $this->getChild('option') ?>
                    <div class="input-box">
                        <label for="qty" class="control-label"><?php echo $this->translate('Qty') ?></label>
                        <div class="cell">
                            <label for="qty" class="spin minus">-</label>
                            <input id="qty" class="form-control required" value="<?php echo (float) $inventory['min_qty'] ?>" 
                                   min="<?php echo (float) $inventory['min_qty'] ?>" 
                                   max="<?php echo min((float) $inventory['max_qty'], (float) $inventory['qty']) ?>" 
                                   step="<?php echo (float) $inventory['increment'] ?>" name="qty" type="number" />
                            <label for="qty" class="spin plus">+</label>
                        </div>
                    </div>
                </div>
                <div class="clearfix action">
                    <button type="submit" class="btn"><?php echo $this->translate('Buy Now') ?></button>
                    <button type="submit" class="btn btn-checkout">
                        <span class="fa fa-shopping-cart" aria-hidden="true"></span>
                        <span><?php echo $this->translate('Add to Cart') ?></span>
                    </button>
                </div> 
            </div>
            <div class="col-lg-2">
                <div class="upsells">
                    <?php echo $this->getChild('upsells')->setVariable('product', $product)->setLimit(3) ?>
                </div>
            </div>
            <div class="related">
                <?php echo $this->getChild('related')->setVariable('product', $product)->setVariable('title', 'Featured Products')->setLimit(7) ?>
            </div>
        </div>        
    </form>
</div>
